[gd_scene format=3 uid="uid://cltl4miymivys"]

[ext_resource type="PackedScene" uid="uid://bqpd5cm5dcy71" path="res://Assets/Characters/XBot.glb" id="1_mdl7e"]
[ext_resource type="Script" uid="uid://btgkhykbev6d6" path="res://Scripts/Player.gd" id="1_script"]
[ext_resource type="Script" uid="uid://bkp6agvjjm47t" path="res://Scripts/Weapon/WeaponMgr.gd" id="2_52ee3"]
[ext_resource type="Script" uid="uid://cgibjq8orsoge" path="res://Scripts/Input/InputMgr.gd" id="2_m0x7a"]
[ext_resource type="Script" uid="uid://ruoxwj2thpuw" path="res://Scripts/Animation/MovementMgr.gd" id="2_megsn"]
[ext_resource type="Animation" uid="uid://cmym1cbyn4tg5" path="res://Assets/Animations/Library/Unarmed/Idle.res" id="2_qu4a1"]
[ext_resource type="Animation" uid="uid://biyh1eubhiecd" path="res://Assets/Animations/Library/Unarmed/Jump.res" id="3_70d11"]
[ext_resource type="Animation" uid="uid://dygqhwo1805bn" path="res://Assets/Animations/Library/SwordAndShield/Idle.res" id="3_nn08x"]
[ext_resource type="Script" uid="uid://d1unb2snnejk0" path="res://Scripts/Animation/AnimationMgr.gd" id="3_ulo2v"]
[ext_resource type="Animation" uid="uid://e3vujykiovi8" path="res://Assets/Animations/Library/Unarmed/Walking.res" id="4_cw2d6"]
[ext_resource type="Script" uid="uid://bu0vvm1a5hov7" path="res://Scripts/Animation/AttackMgr.gd" id="7_ulo2v"]
[ext_resource type="Script" uid="uid://btx5u8pehj2ri" path="res://Scripts/Animation/RollMgr.gd" id="8_5v66d"]
[ext_resource type="Animation" uid="uid://ywb7kg2bg88c" path="res://Assets/Animations/Library/SwordAndShield/Walk.res" id="8_ksbbd"]
[ext_resource type="Animation" uid="uid://bm2d4g8pfoe07" path="res://Assets/Animations/Library/SwordAndShield/DrawSword.res" id="9_miouo"]
[ext_resource type="Animation" uid="uid://dbxxuoc00n3h3" path="res://Assets/Animations/Library/SwordAndShield/SheathSword.1.res" id="10_1e7my"]
[ext_resource type="Animation" uid="uid://25qcudnomvvf" path="res://Assets/Animations/Library/SwordAndShield/SheathSword.2.res" id="11_arntx"]
[ext_resource type="Animation" uid="uid://ccb7gvpctg52q" path="res://Assets/Animations/Library/Roll/Roll.res" id="12_x63xi"]
[ext_resource type="Animation" uid="uid://2xm16atxaaxj" path="res://Assets/Animations/Library/SwordAndShield/Attack.Slash.2.8.res" id="13_lslt6"]
[ext_resource type="Animation" uid="uid://o4xndrx00au6" path="res://Assets/Animations/Library/Unarmed/DrawSword.res" id="13_o3h8g"]
[ext_resource type="Script" uid="uid://qat0bt2h635k" path="res://Scripts/Animation/WeaponSwitchMgr.gd" id="14_switch"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_mdl7e"]
radius = 0.4
height = 1.6

[sub_resource type="AnimationLibrary" id="AnimationLibrary_qu4a1"]

[sub_resource type="AnimationLibrary" id="AnimationLibrary_x63xi"]
_data = {
&"Roll": ExtResource("12_x63xi")
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_5ixxa"]
_data = {
&"Attack.Slash.2.8": ExtResource("13_lslt6"),
&"DrawSword": ExtResource("9_miouo"),
&"Idle": ExtResource("3_nn08x"),
&"SheathSword.1": ExtResource("10_1e7my"),
&"SheathSword.2": ExtResource("11_arntx"),
&"Walk": ExtResource("8_ksbbd")
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_nn08x"]
_data = {
&"DrawSword": ExtResource("13_o3h8g"),
&"Idle": ExtResource("2_qu4a1"),
&"Jump": ExtResource("3_70d11"),
&"Walking": ExtResource("4_cw2d6")
}

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_ulo2v"]
resource_name = "Action_OneShot"
fadein_time = 0.1
fadeout_time = 0.1

[sub_resource type="AnimationNodeTransition" id="AnimationNodeTransition_ulo2v"]
resource_name = "Action_Type"
xfade_time = 0.1
input_0/name = "attack"
input_0/auto_advance = false
input_0/break_loop_at_end = false
input_0/reset = true
input_1/name = "roll"
input_1/auto_advance = false
input_1/break_loop_at_end = false
input_1/reset = true

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qidb7"]
resource_name = "Animation"
animation = &"SwordAndShield/Attack.Slash.2.8"

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_m0x7a"]
resource_name = "Attack_TimeScale"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_utwlt"]
resource_name = "Roll"
animation = &"Roll/Roll"

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_5v66d"]
resource_name = "Roll_TimeScale"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_lslt6"]
resource_name = "blend"
filter_enabled = true
filters = ["%GeneralSkeleton:Chest", "%GeneralSkeleton:Head", "%GeneralSkeleton:LeftHand", "%GeneralSkeleton:LeftIndexDistal", "%GeneralSkeleton:LeftIndexIntermediate", "%GeneralSkeleton:LeftIndexProximal", "%GeneralSkeleton:LeftLittleDistal", "%GeneralSkeleton:LeftLittleIntermediate", "%GeneralSkeleton:LeftLittleProximal", "%GeneralSkeleton:LeftLowerArm", "%GeneralSkeleton:LeftMiddleDistal", "%GeneralSkeleton:LeftMiddleIntermediate", "%GeneralSkeleton:LeftMiddleProximal", "%GeneralSkeleton:LeftRingDistal", "%GeneralSkeleton:LeftRingIntermediate", "%GeneralSkeleton:LeftRingProximal", "%GeneralSkeleton:LeftShoulder", "%GeneralSkeleton:LeftThumbDistal", "%GeneralSkeleton:LeftThumbMetacarpal", "%GeneralSkeleton:LeftThumbProximal", "%GeneralSkeleton:LeftUpperArm", "%GeneralSkeleton:Neck", "%GeneralSkeleton:RightHand", "%GeneralSkeleton:RightIndexDistal", "%GeneralSkeleton:RightIndexIntermediate", "%GeneralSkeleton:RightIndexProximal", "%GeneralSkeleton:RightLittleDistal", "%GeneralSkeleton:RightLittleIntermediate", "%GeneralSkeleton:RightLittleProximal", "%GeneralSkeleton:RightLowerArm", "%GeneralSkeleton:RightMiddleDistal", "%GeneralSkeleton:RightMiddleIntermediate", "%GeneralSkeleton:RightMiddleProximal", "%GeneralSkeleton:RightRingDistal", "%GeneralSkeleton:RightRingIntermediate", "%GeneralSkeleton:RightRingProximal", "%GeneralSkeleton:RightShoulder", "%GeneralSkeleton:RightThumbDistal", "%GeneralSkeleton:RightThumbMetacarpal", "%GeneralSkeleton:RightThumbProximal", "%GeneralSkeleton:RightUpperArm", "%GeneralSkeleton:Spine", "%GeneralSkeleton:UpperChest"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_lslt6"]
resource_name = "Unarmed_Idle"
animation = &"Unarmed/Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ulo2v"]
resource_name = "Unarmed_Walking"
animation = &"Unarmed/Walking"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5v66d"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_m0x7a"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ulo2v"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_ulo2v"]
resource_name = "lower_body_sm"
states/End/position = Vector2(1291, 140)
states/Start/position = Vector2(188, 140)
states/Unarmed_Idle/node = SubResource("AnimationNodeAnimation_lslt6")
states/Unarmed_Idle/position = Vector2(431, 140)
states/Unarmed_Walking/node = SubResource("AnimationNodeAnimation_ulo2v")
states/Unarmed_Walking/position = Vector2(745, 140)
transitions = ["Unarmed_Walking", "Unarmed_Idle", SubResource("AnimationNodeStateMachineTransition_5v66d"), "Unarmed_Idle", "Unarmed_Walking", SubResource("AnimationNodeStateMachineTransition_m0x7a"), "Start", "Unarmed_Idle", SubResource("AnimationNodeStateMachineTransition_ulo2v")]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_arntx"]
resource_name = "SwordAndShield_DrawSword"
animation = &"SwordAndShield/DrawSword"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1iu4k"]
resource_name = "SwordAndShield_Idle"
animation = &"SwordAndShield/Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_m0x7a"]
resource_name = "SwordAndShield_SheathSword_1"
animation = &"SwordAndShield/SheathSword.1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5v66d"]
resource_name = "SwordAndShield_SheathSword_2"
animation = &"SwordAndShield/SheathSword.2"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_x63xi"]
resource_name = "Unarmed_DrawSword"
animation = &"Unarmed/DrawSword"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_i2e8t"]
resource_name = "Unarmed_Idle"
animation = &"Unarmed/Idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qidb7"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_70hv0"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_utwlt"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_kih0c"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_lslt6"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_arntx"]
xfade_time = 0.01

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_1iu4k"]
resource_name = "upper_body_sm"
states/End/position = Vector2(1416, 399)
states/Start/position = Vector2(70, 100)
states/SwordAndShield_DrawSword/node = SubResource("AnimationNodeAnimation_arntx")
states/SwordAndShield_DrawSword/position = Vector2(618, 189)
states/SwordAndShield_Idle/node = SubResource("AnimationNodeAnimation_1iu4k")
states/SwordAndShield_Idle/position = Vector2(1238, 100)
states/SwordAndShield_SheathSword_1/node = SubResource("AnimationNodeAnimation_m0x7a")
states/SwordAndShield_SheathSword_1/position = Vector2(1238, 334)
states/SwordAndShield_SheathSword_2/node = SubResource("AnimationNodeAnimation_5v66d")
states/SwordAndShield_SheathSword_2/position = Vector2(371, 329)
states/Unarmed_DrawSword/node = SubResource("AnimationNodeAnimation_x63xi")
states/Unarmed_DrawSword/position = Vector2(618, 100)
states/Unarmed_Idle/node = SubResource("AnimationNodeAnimation_i2e8t")
states/Unarmed_Idle/position = Vector2(371, 100)
transitions = ["Start", "Unarmed_Idle", SubResource("AnimationNodeStateMachineTransition_qidb7"), "Unarmed_Idle", "Unarmed_DrawSword", SubResource("AnimationNodeStateMachineTransition_70hv0"), "SwordAndShield_SheathSword_1", "SwordAndShield_SheathSword_2", SubResource("AnimationNodeStateMachineTransition_utwlt"), "SwordAndShield_SheathSword_2", "Unarmed_Idle", SubResource("AnimationNodeStateMachineTransition_kih0c"), "Unarmed_DrawSword", "SwordAndShield_DrawSword", SubResource("AnimationNodeStateMachineTransition_lslt6"), "SwordAndShield_DrawSword", "Unarmed_Idle", SubResource("AnimationNodeStateMachineTransition_arntx")]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_m0x7a"]
graph_offset = Vector2(-247.94366, 57.474884)
nodes/output/position = Vector2(1220, 200)
nodes/lower_body_sm/node = SubResource("AnimationNodeStateMachine_ulo2v")
nodes/lower_body_sm/position = Vector2(180, 120)
nodes/upper_body_sm/node = SubResource("AnimationNodeStateMachine_1iu4k")
nodes/upper_body_sm/position = Vector2(180, 320)
nodes/blend/node = SubResource("AnimationNodeBlend2_lslt6")
nodes/blend/position = Vector2(520, 180)
nodes/Action_OneShot/node = SubResource("AnimationNodeOneShot_ulo2v")
nodes/Action_OneShot/position = Vector2(880, 180)
nodes/Animation/node = SubResource("AnimationNodeAnimation_qidb7")
nodes/Animation/position = Vector2(80, 540)
nodes/Action_Type/node = SubResource("AnimationNodeTransition_ulo2v")
nodes/Action_Type/position = Vector2(700, 500)
nodes/Roll/node = SubResource("AnimationNodeAnimation_utwlt")
nodes/Roll/position = Vector2(220, 820)
nodes/Attack_TimeScale/node = SubResource("AnimationNodeTimeScale_m0x7a")
nodes/Attack_TimeScale/position = Vector2(440, 480)
nodes/Roll_TimeScale/node = SubResource("AnimationNodeTimeScale_5v66d")
nodes/Roll_TimeScale/position = Vector2(440, 780)
node_connections = [&"output", 0, &"Action_OneShot", &"blend", 0, &"lower_body_sm", &"blend", 1, &"upper_body_sm", &"Action_OneShot", 0, &"blend", &"Action_OneShot", 1, &"Action_Type", &"Action_Type", 0, &"Attack_TimeScale", &"Action_Type", 1, &"Roll_TimeScale", &"Attack_TimeScale", 0, &"Animation", &"Roll_TimeScale", 0, &"Roll"]

[node name="Player" type="CharacterBody3D" unique_id=210907959 groups=["Player"]]
script = ExtResource("1_script")

[node name="MeshInstance3D" type="MeshInstance3D" parent="." unique_id=1785551669]

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=1854881102]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.8, 0)
shape = SubResource("CapsuleShape3D_mdl7e")

[node name="InputMgr" type="Node" parent="." unique_id=2073659481]
script = ExtResource("2_m0x7a")

[node name="AnimationMgr" type="Node" parent="." unique_id=1109611017]
script = ExtResource("3_ulo2v")
animation_tree_path = NodePath("../AnimationTree")

[node name="MovementMgr" type="Node" parent="." unique_id=751856138]
script = ExtResource("2_megsn")

[node name="WeaponMgr" type="Node" parent="." unique_id=1272631338]
script = ExtResource("2_52ee3")
weapon_attachment_path = NodePath("../XBot/Skeleton/GeneralSkeleton/RightHandAttachment")

[node name="WeaponSwitchMgr" type="Node" parent="." unique_id=233422225]
script = ExtResource("14_switch")

[node name="AttackMgr" type="Node" parent="." unique_id=1768348230]
script = ExtResource("7_ulo2v")

[node name="RollMgr" type="Node" parent="." unique_id=1949914716]
script = ExtResource("8_5v66d")

[node name="XBot" parent="." unique_id=520564406 instance=ExtResource("1_mdl7e")]

[node name="GeneralSkeleton" parent="XBot/Skeleton" index="0"]
bones/0/position = Vector3(-0.00096289144, 1.028263, 0.018574195)
bones/0/rotation = Quaternion(0.033138297, -0.032400284, -0.0025666833, 0.9989222)
bones/1/rotation = Quaternion(0.113554806, -0.020890903, -0.023677249, 0.9930299)
bones/2/rotation = Quaternion(0.00021336973, -0.0032482217, -0.019011322, 0.999814)
bones/3/rotation = Quaternion(0.00021608174, -0.0026270258, -0.019084956, 0.9998144)
bones/4/rotation = Quaternion(0.116845354, 0.022608934, 0.0815337, 0.98953944)
bones/5/rotation = Quaternion(-0.07770893, 0.11898288, 0.047745787, 0.9886986)
bones/7/rotation = Quaternion(0.3125944, -0.6300672, -0.63616574, -0.31716442)
bones/8/rotation = Quaternion(-0.6532074, 0.6402262, -0.036726594, 0.4025938)
bones/9/rotation = Quaternion(0.18880983, 0.5376596, -0.5645029, 0.5971679)
bones/10/rotation = Quaternion(0.105187416, -0.64428705, 0.3722733, 0.65972906)
bones/11/rotation = Quaternion(0.1312612, -0.74088705, -0.22269598, 0.61988986)
bones/12/rotation = Quaternion(-0.08322947, -0.14080168, 0.0840883, 0.98294306)
bones/13/rotation = Quaternion(0.17847992, 0.05012466, 0.13625884, 0.9731732)
bones/15/rotation = Quaternion(0.5105593, 0.014056368, 0.022454528, 0.8594343)
bones/16/rotation = Quaternion(0.5486878, -0.021102143, -0.032016512, 0.83514744)
bones/17/rotation = Quaternion(0.49576065, -0.012686109, 0.011556475, 0.8682897)
bones/19/rotation = Quaternion(0.5611521, 0.009508385, -0.0051871235, 0.8276419)
bones/20/rotation = Quaternion(0.67174226, -0.028260253, -0.032113284, 0.7395489)
bones/21/rotation = Quaternion(0.2814726, -0.0044158543, 0.013429908, 0.9594652)
bones/23/rotation = Quaternion(0.6366021, 0.019719293, 0.03592163, 0.770103)
bones/24/rotation = Quaternion(0.5965247, -0.00089020643, -0.011695682, 0.802509)
bones/25/rotation = Quaternion(0.33498144, 0.0040416415, 0.009663968, 0.94216657)
bones/27/rotation = Quaternion(0.6864352, 0.024414089, -0.024272975, 0.72637564)
bones/28/rotation = Quaternion(0.4572153, -8.575616e-06, -0.0005854963, 0.88935584)
bones/29/rotation = Quaternion(0.22350392, 4.768371e-06, -0.0002748966, 0.9747031)
bones/31/rotation = Quaternion(0.4260769, 0.5187228, 0.66396034, -0.32945698)
bones/32/rotation = Quaternion(0.15108752, 0.97282434, -0.17400645, 0.022520913)
bones/33/rotation = Quaternion(0.2867349, -0.67921686, 0.19722378, 0.64618146)
bones/34/rotation = Quaternion(0.08055862, 0.70419693, 0.0345915, 0.7045711)
bones/35/rotation = Quaternion(-0.09020966, 0.6681813, 0.33393747, 0.658697)
bones/36/rotation = Quaternion(0.09899, 0.18079098, 0.025802948, 0.9781871)
bones/37/rotation = Quaternion(-0.12484299, 0.4751862, 0.36857235, 0.7891558)
bones/39/rotation = Quaternion(0.73922926, 0.012283988, 0.08984054, 0.6673215)
bones/40/rotation = Quaternion(0.62484264, 0.023946129, 0.02987048, 0.7798116)
bones/41/rotation = Quaternion(0.65585035, 0.0113126375, -0.0129238665, 0.7546956)
bones/43/rotation = Quaternion(0.7736265, -0.0658042, 0.016983598, 0.6299868)
bones/44/rotation = Quaternion(0.6957288, 0.02928153, 0.031161696, 0.71703076)
bones/45/rotation = Quaternion(0.625967, 0.009410389, -0.0103242695, 0.7797244)
bones/47/rotation = Quaternion(0.79204273, -0.060743757, -0.004400223, 0.60742)
bones/48/rotation = Quaternion(0.57060516, -0.0057398826, 0.009748757, 0.8211466)
bones/49/rotation = Quaternion(0.67100286, -0.0077094566, -0.0069523454, 0.7413821)
bones/51/rotation = Quaternion(0.754003, -0.12598102, -0.013030617, 0.64454514)
bones/52/rotation = Quaternion(0.67797744, 9.658467e-05, 0.0007632673, 0.7350823)
bones/53/rotation = Quaternion(0.46105516, 3.4354623e-05, 0.00053915376, 0.88737124)
bones/55/rotation = Quaternion(-0.0809207, 0.07553549, 0.9919502, 0.061491594)
bones/56/rotation = Quaternion(0.024131035, 0.9985982, -0.044770982, 0.014664363)
bones/57/rotation = Quaternion(0.05730517, 0.70576805, -0.70327383, -0.063352205)
bones/58/rotation = Quaternion(5.3505908e-05, 0.99999094, -0.0021258302, -0.0036836967)
bones/60/rotation = Quaternion(0.11486609, 0.07052211, 0.9881663, -0.07321227)
bones/61/rotation = Quaternion(-0.021734739, 0.9966722, -0.06674647, 0.04143851)
bones/62/rotation = Quaternion(-0.056003366, 0.69483894, -0.7142661, 0.062342104)
bones/63/rotation = Quaternion(-2.636854e-05, 0.9999899, -0.002251685, 0.0039076097)

[node name="RightHandAttachment" type="BoneAttachment3D" parent="XBot/Skeleton/GeneralSkeleton" index="2" unique_id=1882066302]
transform = Transform3D(0.09702052, 0.42200047, -0.90138954, 0.12563956, -0.90361, -0.40951693, -0.98732066, -0.073518515, -0.14068872, 0.18969123, 1.1116045, 0.16061464)
bone_name = "RightHand"
bone_idx = 10

[node name="AnimationPlayer" parent="XBot" index="1"]
libraries/ = SubResource("AnimationLibrary_qu4a1")
libraries/Roll = SubResource("AnimationLibrary_x63xi")
libraries/SwordAndShield = SubResource("AnimationLibrary_5ixxa")
libraries/Unarmed = SubResource("AnimationLibrary_nn08x")

[node name="AnimationTree" type="AnimationTree" parent="." unique_id=1922765421]
root_node = NodePath("../XBot")
tree_root = SubResource("AnimationNodeBlendTree_m0x7a")
anim_player = NodePath("../XBot/AnimationPlayer")
parameters/blend/blend_amount = 1.0
parameters/Action_OneShot/active = false
parameters/Action_OneShot/internal_active = false
parameters/Action_OneShot/request = 0
parameters/Action_Type/current_state = ""
parameters/Action_Type/transition_request = ""
parameters/Action_Type/current_index = -1
parameters/Attack_TimeScale/scale = 1.0
parameters/Roll_TimeScale/scale = 2.0

[editable path="XBot"]
